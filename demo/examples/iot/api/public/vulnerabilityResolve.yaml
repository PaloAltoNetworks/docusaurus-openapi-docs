parameters:
  - description: The customer ID to which the API call is directed
    in: query
    name: customerid
    required: true
    schema:
      type: string
requestBody:
  required: true
  content:
    application/json:
      schema:
        type: object
        required:
          - ticketIdList
          - action
          - reason
          - full_name
        properties:
          ticketIdList:
            type: string
            description: "A list of one or more ticket IDs for vulnerability instances being resolved. If you include the ticket IDs for multiple vulnerability instances, separate them by commas; for example: “ticketIdList”: [“vuln-1a4a72c2”, “vuln-1a4a72c3”, “vuln-1a4a72c4”] To retrieve a list of vulnerabilities and vulnerability instances, including their ticket IDs, use Get Vulnerabilities and refer to the zb_ticketid values."
          action:
            type: string
            description: The action employed to resolve the vulnerability instance. The following value must be either <b>mitigate</b> or <b>ignore</b>.
          reason:
            type: string
            description: The reason for resolving the vulnerability instance. The following value cannot contain any special characters.
          full_name:
            type: string
            description: The name of the vulnerability; for example, CVE-2018-18568
      examples:
        payloadExample:
          summary: An example of payload of resolving a vulnerability instance
          value:
            reason: Threat was removed
            full_name: CVE-2018-18568
            ticketIdList: ["vuln-1a4a72c2"]
            action: mitigate

responses:
  "200":
    description: Successful Response
    content:
      application/json:
        examples:
          resolveSecurityAlertResponseExample:
            $ref: "../../components/examples.yaml#/examples/ResolveVulnerabilityInstanceResponseExample"
  "4XX":
    description: Client Error Response
    content:
      application/json:
        schema:
          $ref: "../../components/schemas.yaml#/schemas/ErrorResponse"
        examples:
          Bad Request:
            $ref: "../../components/examples.yaml#/examples/BadRequestResponseExample"
          Forbidden access:
            $ref: "../../components/examples.yaml#/examples/UnauthorizedResponseExample"
          Too many requests:
            $ref: "../../components/examples.yaml#/examples/RateLimitResponseExample"
  "5XX":
    description: Server Error Response
    content:
      application/json:
        schema:
          $ref: "../../components/schemas.yaml#/schemas/ErrorResponse"
        examples:
          resolveSecurityAlertResponseExample:
            $ref: "../../components/examples.yaml#/examples/ServerErrorResponseExample"
