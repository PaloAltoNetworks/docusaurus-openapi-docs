parameters:
  - description: The customer ID to which the API call is directed
    in: query
    name: customerid
    required: true
    schema:
      type: string
  - description: Optional field setting the start of a time range for retrieving vulnerability instances. For example, to get all instances since November 3, 2020, starting at 00:00 AM in the Pacific Time Zone(UTC-8), the start time would be <b>stime=2020-11-3T08:00Z</b>. <br />If you prefer to specify the time in your local time rather than adjusting it to UTC time, you can also format the start time as <b>2020-11-03T:00:00-08:00</b>. Especially when starting at a later hour in the day, this format involves less calculating. For example, if you want to get vulnerability instances starting from 6:00 PM on November 3, 2020, entering <b>2020-11-03T18:00-08:00</b> is much simpler than entering <b>2020-11-04T02:00Z</b>.
    in: query
    name: stime
    required: false
    schema:
      type: string
  - description: Optional field that sets the start of a time range for retrieving vulnerabilities created in the database or that have been updated. When this field is used, the stime field is ignored.
    in: query
    name: updatedCreatedAfter
    required: false
    schema:
      type: string
      format: date-time
  - description: "The number of items in one response; that is, in one page. The default page length for vulnerabilities is 1000 and the maximum is 1000. Setting a shorter length improves response times. Note: The <b>pagelength</b> parameter is only valid when grouping vulnerability instances by device, not when grouping them by vulnerability."
    in: query
    name: pagelength
    required: false
    schema:
      type: integer
  - description: "In addition to the pagelength parameter, offset gets items on subsequent pages. For example, if the page length of your first request is 100, you get the first 100 vulnerabilities. To get the next 100, add offset=100 to your second request. This skips the first 100 vulnerabilities and gets the next 100 starting from 101. Note: The <b>offset</b> parameter is only valid when grouping vulnerability instances by device, not when grouping them by vulnerability."
    in: query
    name: offset
    required: false
    schema:
      type: integer
  - description: The name of a specific vulnerability. If omitted, all vulnerabilities are returned.
    in: query
    name: name
    required: false
    schema:
      type: string
  - description: "The status of vulnerabilities to be retrieved: confirmed or potential vulnerabilities. The following field is either the string “Confirmed” or “Potential”. If no value is passed, both types of vulnerabilities are returned."
    in: query
    name: status
    required: false
    schema:
      type: string
  - description: "The grouping of device vulnerability instances in query results. Each <b>groupby</b> option results in a different JSON object structure in the response. <b>groupby=vulnerability</b> (the default) organizes results into groups by vulnerability. Each vulnerability and the device IDs impacted are an item in the items list. <b>groupby=device</b> organizes results into groups by device ID. Each device ID and a single vulnerability are an item in the items list. <br /> To request all vulnerability instances for a specific device, the value is the string <b>vulnerability</b> followed by <b>&deviceid='<'device_id'>'</b>, where the device ID is either a MAC address or, for static IP devices, an IP address. (Entering an IP address for a device whose device identifier is a MAC address doesn’t work. Similarly, entering a MAC address for a device whose device identifier is an IP address also doesn’t work.)"
    in: query
    name: groupby
    required: false
    schema:
      type: string
responses:
  "200":
    description: Successful Response (We only show some important fields here.)
    content:
      application/json:
        schema:
          $ref: "../../components/schemas.yaml#/schemas/IoTVulnerabilyListResponse"
        examples:
          vulnerabilityListResponseExample:
            $ref: "../../components/examples.yaml#/examples/VulnerabilityListResponseExample"
  "4XX":
    description: Client Error Response
    content:
      application/json:
        schema:
          $ref: "../../components/schemas.yaml#/schemas/ErrorResponse"
        examples:
          Bad Request:
            $ref: "../../components/examples.yaml#/examples/BadRequestResponseExample"
          Forbidden access:
            $ref: "../../components/examples.yaml#/examples/UnauthorizedResponseExample"
          Too many requests:
            $ref: "../../components/examples.yaml#/examples/RateLimitResponseExample"
  "5XX":
    description: Server Error Response
    content:
      application/json:
        schema:
          $ref: "../../components/schemas.yaml#/schemas/ErrorResponse"
        examples:
          vulnerabilityListResponseExample:
            $ref: "../../components/examples.yaml#/examples/ServerErrorResponseExample"
